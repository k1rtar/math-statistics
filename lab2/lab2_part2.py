import numpy as np
from scipy.stats import laplace, norm

# Функция для вычисления доверительного интервала
def confidence_interval(n, mu, b, alpha=0.05):
    # Генерируем выборку из распределения Лапласса
    X = laplace.rvs(loc=mu, scale=b, size=n)
    # Вычисляем выборочную медиану
    median = np.median(X)
    # Вычисляем стандартную ошибку (в данном случае это стандартное отклонение распределения Лапласса, деленное на корень из размера выборки)
    se = b / np.sqrt(n)
    # Вычисляем квантили стандартного нормального распределения
    z = norm.ppf(1 - alpha/2)
    # Вычисляем границы доверительного интервала
    lower = median - z * se
    upper = median + z * se
    return lower, upper

# Функция для проведения эксперимента
def experiment(n, mu, b, num_trials=1000):
    count = 0
    for _ in range(num_trials):
        # Вычисляем доверительный интервал
        lower, upper = confidence_interval(n, mu, b)
        # Проверяем, покрывает ли доверительный интервал истинное значение параметра
        if lower <= mu <= upper:
            count += 1
    # Возвращаем долю случаев, когда доверительный интервал покрывает истинное значение параметра
    return count / num_trials

# Запускаем эксперимент для выборок разного объема
n = 25
mu = 2
b = 1
coverage_rate_25 = experiment(n, mu, b)
print(f"Для выборки объемом {n}, 95%-ный доверительный интервал покрывает истинное значение параметра в {coverage_rate_25*100}% случаев.")

n = 10000
coverage_rate_10000 = experiment(n, mu, b)
print(f"Для выборки объемом {n}, 95%-ный доверительный интервал покрывает истинное значение параметра в {coverage_rate_10000*100}% случаев.")

print("\nВывод:")
print(f"Доля случаев, когда доверительный интервал покрывает истинное значение параметра, увеличилась с {coverage_rate_25*100}% до {coverage_rate_10000*100}% при увеличении объема выборки с 25 до 10000.")
print("Это связано с тем, что при увеличении объема выборки, выборочная медиана становится более точной оценкой среднего значения генеральной совокупности, и доверительный интервал становится уже. Следовательно, вероятность того, что доверительный интервал будет содержать истинное значение параметра, увеличивается.")
